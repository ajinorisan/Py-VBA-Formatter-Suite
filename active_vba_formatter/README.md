# Active VBA Formatter

## æ¦‚è¦ (Overview)

<details>
<summary><strong>ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (Japanese)</strong></summary>

---

**Active VBA Formatter** ã¯ã€Excel VBAã®é–‹ç™ºåŠ¹ç‡ã‚’åŠ‡çš„ã«å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã§ã™ã€‚

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ã€ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ãªã£ã¦ã„ã‚‹Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¸¸æ™‚ç›£è¦–ã—ã¾ã™ã€‚ã‚ãªãŸãŒVBEï¼ˆVisual Basic Editorï¼‰ã§ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ãŸã³ã«ã€ç¬æ™‚ã«ã‚³ãƒ¼ãƒ‰ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’ç¾ã—ãæ•´å½¢ã—ã¾ã™ã€‚

æ‰‹å‹•ã§ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆèª¿æ•´ã¨ã„ã†ç…©ã‚ã—ã„ä½œæ¥­ã‹ã‚‰è§£æ”¾ã•ã‚Œã€ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãã®ã‚‚ã®ã«é›†ä¸­ã§ãã‚‹ç’°å¢ƒã‚’æä¾›ã—ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

-   **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–**: ãƒ•ã‚©ã‚¢ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã®Excelãƒ–ãƒƒã‚¯ã‚’è‡ªå‹•ã§èªè­˜ã—ã€ç›£è¦–å¯¾è±¡ã‚’å‹•çš„ã«åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚
-   **è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: VBAã‚³ãƒ¼ãƒ‰ã®ä¿å­˜ (`Ctrl+S`) ã‚’æ¤œçŸ¥ã—ã€ç¬æ™‚ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’æ•´å½¢ã—ã¾ã™ã€‚
    -   `If`, `Select Case`, `For`, `Do`, `With`, `Sub`, `Function`, `Property` ç­‰ã®ãƒ–ãƒ­ãƒƒã‚¯æ§‹é€ ã«å¯¾å¿œã€‚
    -   ãƒã‚¹ãƒˆã•ã‚ŒãŸè¤‡é›‘ãªãƒ–ãƒ­ãƒƒã‚¯æ§‹é€ ã‚‚æ­£ç¢ºã«è§£æã—ã¾ã™ã€‚
-   **ã‚¹ãƒãƒ¼ãƒˆãªçµ‚äº†å‡¦ç†**: ç›£è¦–å¯¾è±¡ã®ExcelãŒã™ã¹ã¦çµ‚äº†ã™ã‚‹ã¨ã€ãƒ„ãƒ¼ãƒ«ã‚’çµ‚äº†ã™ã‚‹ã‹ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

![active_vba_formatter_jp](https://github.com/user-attachments/assets/0031d017-c571-49c0-a427-37a4ae651631)

### å‹•ä½œç’°å¢ƒ

-   **OS**: Windows 10 / 11 (æœ¬ãƒ„ãƒ¼ãƒ«ã¯Windowså°‚ç”¨ã§ã™)
-   **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: Microsoft Excel

### ä½¿ã„æ–¹

#### å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« (.exe) ã‚’ä½¿ã† (æ¨å¥¨)

Pythonã®ç’°å¢ƒæ§‹ç¯‰ãŒä¸è¦ãªãŸã‚ã€ã»ã¨ã‚“ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã“ã®æ–¹æ³•ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

1.  **ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**
    -   æœ¬ãƒªãƒã‚¸ãƒˆãƒªã® [**Releasesãƒšãƒ¼ã‚¸**](https://github.com/TC-AJINORI/Py-VBA-Formatter-Suite/tree/main/_Releases) ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
    -   æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ã‚»ãƒƒãƒˆã‹ã‚‰ `active_vba_formatter.exe` ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

2.  **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹é‡è¦ãªæ³¨æ„**
    -   æœ¬ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯é–‹ç™ºè€…ã«ã‚ˆã‚‹ãƒ‡ã‚¸ã‚¿ãƒ«ç½²åãŒè¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã‚„å®Ÿè¡Œæ™‚ã« **Windows Defender SmartScreen** ã‚„ãŠä½¿ã„ã®ã‚¢ãƒ³ãƒã‚¦ã‚¤ãƒ«ã‚¹ã‚½ãƒ•ãƒˆã«ã‚ˆã£ã¦è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
    -   ã“ã‚Œã¯ã€æœªçŸ¥ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã™ã‚‹æ¨™æº–çš„ãªä¿è­·æ©Ÿèƒ½ã§ã‚ã‚Šã€å¿…ãšã—ã‚‚ã‚¦ã‚¤ãƒ«ã‚¹ã‚’æ„å‘³ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
    -   å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ“ä½œã—ã¦ãã ã•ã„ã€‚
        -   Windowsã®è­¦å‘Šç”»é¢ã§ **è©³ç´°æƒ…å ±** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
        -   æ¬¡ã«è¡¨ç¤ºã•ã‚Œã‚‹ **å®Ÿè¡Œ** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
    -   æœ¬ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŠã‚ˆã³å®Ÿè¡Œã¯ã€ã“ã‚Œã‚‰ã®ãƒªã‚¹ã‚¯ã‚’ç†è§£ã—ãŸä¸Šã§ã€**è‡ªå·±ã®è²¬ä»»ã«ãŠã„ã¦**è¡Œã£ã¦ãã ã•ã„ã€‚

3.  **ãƒ„ãƒ¼ãƒ«ã®èµ·å‹•**
    -   ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ `active_vba_formatter.exe` ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚
    -   ãƒ„ãƒ¼ãƒ«ãŒãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§èµ·å‹•ã—ã€Excelã®ç›£è¦–ã‚’é–‹å§‹ã—ã¾ã™ã€‚

### æ³¨æ„äº‹é …

-   VBAãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚³ãƒ¼ãƒ‰ã®èª­ã¿æ›¸ããŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ãŸã‚ã€æœ¬ãƒ„ãƒ¼ãƒ«ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚
-   ExcelãŒã€Œå¿œç­”ãªã—ã€ã®çŠ¶æ…‹ã«ãªã‚‹ã¨ã€COMæ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã€ç›£è¦–ãŒä¸­æ–­ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚è©³ç´°ã¯ `LICENSE` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚

---
</details>

<br>

<details>
<summary><strong>ğŸ‡¬ğŸ‡§ English (è‹±èª)</strong></summary>

---

**Active VBA Formatter** is a real-time code formatter designed to dramatically improve the development efficiency of Excel VBA.

This tool runs in the background and constantly monitors the currently active Excel file. Every time you write code in the VBE (Visual Basic Editor) and save the file, it instantly and beautifully formats the code indentation.

It frees you from the tedious task of manual indentation, providing an environment where you can focus solely on coding.

### Features

-   **Real-time Monitoring**: Automatically recognizes the foreground Excel workbook and dynamically switches the monitoring target.
-   **Automatic Formatting**: Detects when VBA code is saved (`Ctrl+S`) and instantly formats the indentation.
    -   Supports block structures such as `If`, `Select Case`, `For`, `Do`, `With`, `Sub`, `Function`, and `Property`.
    -   Accurately parses complex nested block structures.
-   **Smart Exit Handling**: Displays a confirmation dialog to exit the tool when all monitored Excel windows are closed.

### Screenshot

![active_vba_formatter_en](https://github.com/user-attachments/assets/0031d017-c571-49c0-a427-37a4ae651631)

### System Requirements

-   **OS**: Windows 10 / 11 (This tool is for Windows only)
-   **Application**: Microsoft Excel

### Usage

#### Using the executable file (.exe) (Recommended)

This method is recommended for most users as it does not require setting up a Python environment.

1.  **Download the File**
    -   Access the [**Releases page**](https://github.com/TC-AJINORI/Py-VBA-Formatter-Suite/tree/main/_Releases) of this repository.
    -   Download `active_vba_formatter.exe` from the assets of the latest version.

2.  **Important Security Note**
    -   This program is not digitally signed by the developer. Therefore, you may see warnings from **Windows Defender SmartScreen** or your antivirus software when downloading or running it.
    -   This is a standard protection feature for unknown executables and does not necessarily mean it is a virus.
    -   To run it, please follow these steps:
        -   On the Windows warning screen, click **More info**.
        -   Then, click the **Run anyway** button that appears.
    -   Please download and run this program **at your own risk**, understanding these factors.

3.  **Launch the Tool**
    -   Double-click the downloaded `active_vba_formatter.exe` to run it.
    -   The tool will start in the background and begin monitoring Excel.

### Notes

-   If a VBA project is password-protected, this tool will not function as code reading and writing will be blocked.
-   If Excel becomes "Not Responding," a COM connection error may occur, and monitoring may be interrupted.

### License

This project is licensed under the MIT License - see the `LICENSE` file for details.

---
</details>
